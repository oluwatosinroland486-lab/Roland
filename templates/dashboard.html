<!DOCTYPE html>
<html>
<head>
    <title>Dashboard</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* align content at top */
            background-color: aquamarine;
            margin: 0;
        }
        #pdfViewer {
            border: 1px solid #ccc;
            padding: 10px;
            max-height: 400px;
            overflow-y: scroll;
        }
        canvas {
            display: block;
            margin: 10px auto;
            border: 1px solid #ddd;
        }

        .sidebar {
            position: fixed;
            width: 250px;
            top: 0;
            left: 0;
            height: 100vh; /* full viewport height */
            background-color: darksalmon;
            padding-top: 20px;
        }

        .sidebar a {
            display: block;
            color: crimson;
            padding: 15px;
            text-decoration: none;
            transition: background 0.3s, color 0.3s;
        }

        .sidebar a:hover {
            background-color: black;  /* Hover effect */
            color: white;
        }
        
        /* Page content */
        .content {
            margin-left: 250px;  /* Same as sidebar width */
            padding: 20px;
            flex: 1;
        }
    </style>
</head>
<body>
    
    <div class="sidebar">
        <a href="login.html">Home</a>
        <a href="services.html">Services</a>
        <a href="#clients">Clients</a>
        <a href="#contact">Contact</a>
    </div>

    <div class="content">
        <h1>Upload PDF and Read Aloud</h1>
  
        <!-- Upload PDF -->
        <input type="file" id="pdfUpload" accept="application/pdf"><br><br>
        
        <!-- Page selector -->
        <label for="startPage">Start from page:</label>
        <input type="number" id="startPage" min="1" value="1"><br><br>
        
        <!-- Buttons -->
        <button onclick="readPDF()">üîä Read PDF</button>
        <button onclick="stopSpeech()">‚èπ Stop</button>
        
        <!-- PDF Viewer -->
        <div id="pdfViewer"></div>
    </div>

    <!-- Import PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>
      let pdfDoc = null;
      let pdfTextByPage = [];

      // Load and render PDF
      document.getElementById("pdfUpload").addEventListener("change", async function(e) {
        const file = e.target.files[0];
        if (file) {
          const fileReader = new FileReader();
          fileReader.onload = async function() {
            const typedArray = new Uint8Array(this.result);
            pdfDoc = await pdfjsLib.getDocument({ data: typedArray }).promise;
            pdfTextByPage = [];

            const viewer = document.getElementById("pdfViewer");
            viewer.innerHTML = "";

            // Loop through all pages
            for (let i = 1; i <= pdfDoc.numPages; i++) {
              const page = await pdfDoc.getPage(i);

              // Extract text
              const textContent = await page.getTextContent();
              let pageText = "";
              textContent.items.forEach(item => {
                pageText += item.str + " ";
              });
              pdfTextByPage.push(pageText);

              // Render page visually
              const viewport = page.getViewport({ scale: 1 });
              const canvas = document.createElement("canvas");
              const context = canvas.getContext("2d");
              canvas.height = viewport.height;
              canvas.width = viewport.width;
              viewer.appendChild(canvas);

              await page.render({ canvasContext: context, viewport: viewport }).promise;
            }
            alert("PDF loaded! Select a page and click 'Read PDF'.");
          };
          fileReader.readAsArrayBuffer(file);
        }
      });

      // Speak from selected page
      function readPDF() {
        if (!pdfDoc) {
          alert("Please upload a PDF first!");
          return;
        }
        const startPage = parseInt(document.getElementById("startPage").value);
        if (startPage < 1 || startPage > pdfDoc.numPages) {
          alert("Invalid page number!");
          return;
        }

        // Concatenate text from selected page onward
        let textToRead = "";
        for (let i = startPage - 1; i < pdfTextByPage.length; i++) {
          textToRead += pdfTextByPage[i] + "\n";
        }

        const utterance = new SpeechSynthesisUtterance(textToRead);
        utterance.rate = 1;
        utterance.pitch = 1;
        utterance.volume = 1;
        window.speechSynthesis.speak(utterance);
      }

      function stopSpeech() {
        window.speechSynthesis.cancel();
      }
    </script> 
</body>
</html>
